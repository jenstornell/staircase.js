var staircase=function(){var e={},t={};return e.init=function(a){t=Object.assign({},e.defaults(),a),document.addEventListener("DOMContentLoaded",function(t){document.querySelector("stair-case").dataset.scName="/",e.ajax("/")})},e.defaults=function(){return{ajaxPath:"ajax.php",selector:"stair-case",prefix:"sc"}},e.ajax=function(a){var c={};c.id=a,console.log(a);var n=JSON.stringify(c);document.querySelector('[data-sc-name="'+a+'"]').classList.add("sc-loading"),fetch(t.ajaxPath,{method:"POST",body:n,headers:{"Content-Type":"application/json"}}).then(function(e){return e.text()}).then(function(t){var c=JSON.parse(t),n=e.createList(c);let s=document.querySelector('[data-sc-name="'+a+'"]');s.appendChild(n),s.dataset.children="",s.classList.remove("sc-loading"),e.eventClickName(),e.eventClickFolder()})},e.createList=function(t){var a=document.createElement("ul");a.classList.add("sc-children");let c=e.toFilesFolders(t);return c.folders.forEach(function(t){let c=e.createLi(t);if(t.parentNode){t.parentNode.closest("[data-sc-name]")}console.log(parentName),c.dataset.scType="folder",c.dataset.scName=t,a.appendChild(c)}),c.files.forEach(function(t){let c=e.createLi(t);c.dataset.scType="file",c.dataset.scName=t,a.appendChild(c)}),a},e.createLi=function(e){let t=document.createElement("li"),a=document.createElement("div"),c=document.createElement("div"),n=document.createElement("div"),s=document.createTextNode(e);return c.classList.add("sc-icon"),n.classList.add("sc-name"),a.classList.add("sc-current"),n.appendChild(s),a.appendChild(c),a.appendChild(n),t.appendChild(a),t},e.toFilesFolders=function(t){var a=[];a.folders=[],a.files=[];let c=0;return t.forEach(function(t){e.isFolder(t)?a.folders[c]=t.slice(0,-1):a.files[c]=t,c++}),a.folders.sort(),a.files.sort(),a},e.isFolder=function(e){return"/"==e[e.length-1]},e.eventClickName=function(){document.querySelectorAll("stair-case li .sc-name").forEach(function(a){a.addEventListener("click",function(a){let c=a.currentTarget.closest("li"),n=e.setData(c);e.removeActive(),e.setActive(c),t.callback(n)})})},e.eventClickFolder=function(){document.querySelectorAll('stair-case li[data-sc-type="folder"] .sc-icon').forEach(function(t){t.addEventListener("click",function(t){let a=t.currentTarget.closest("li"),c=a.dataset.scName,n=a.parentNode.closest("[data-sc-name]").dataset.scName+c;n=e.trimSlashes(n),e.ajax(n)})})},e.trimSlashes=function(e){return e.replace(/^\/|\/$/g,"")},e.setData=function(e){var t={};return t.element=e,t.name=e.dataset.scName,t.type=e.dataset.scType,t},e.removeActive=function(){document.querySelectorAll("stair-case li").forEach(function(e){e.classList.remove("sc-active")})},e.setActive=function(e){e.classList.add("sc-active")},e}();
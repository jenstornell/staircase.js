var staircase=function(){var e={},t={};return e.init=function(a){t=Object.assign({},e.defaults(),a),document.addEventListener("DOMContentLoaded",function(t){document.querySelector("stair-case").dataset.scName="/",e.ajax("/")})},e.defaults=function(){return{ajaxPath:"ajax.php",selector:"stair-case",prefix:"sc"}},e.ajax=function(a){var c={};c.id=a;var n=JSON.stringify(c);let s=document.querySelector('[data-sc-name="'+a+'"]');s.classList.add("sc-loading"),fetch(t.ajaxPath,{method:"POST",body:n,headers:{"Content-Type":"application/json"}}).then(function(e){return e.text()}).then(function(c){s.classList.remove("sc-loading");let n={};if(n.id=a,n.element=s,e.isJson(c)){var i=JSON.parse(c),r=e.createList(i,a);let t=document.querySelector('[data-sc-name="'+a+'"]');t.appendChild(r),t.dataset.children="",t.dataset.scState="open",e.eventClickName(),e.eventClickFolder(t),e.eventClickToggle(t),n.success=!0}else n.success=!1;t.callbackAfterLoad(n)})},e.isJson=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},e.createList=function(t,a){var c=document.createElement("ul");c.classList.add("sc-children");let n=e.toFilesFolders(t);return n.folders.forEach(function(t){let n=e.createLi(t),s=e.trimSlashes(a+"/"+t);n.dataset.scType="folder",n.dataset.scName=s,c.appendChild(n)}),n.files.forEach(function(t){let a=e.createLi(t);a.dataset.scType="file",a.dataset.scName=t,c.appendChild(a)}),c},e.createLi=function(e){let t=document.createElement("li"),a=document.createElement("div"),c=document.createElement("div"),n=document.createElement("div"),s=document.createTextNode(e);return c.classList.add("sc-icon"),n.classList.add("sc-name"),a.classList.add("sc-current"),n.appendChild(s),a.appendChild(c),a.appendChild(n),t.appendChild(a),t},e.toFilesFolders=function(t){var a=[];a.folders=[],a.files=[];let c=0;return t.forEach(function(t){e.isFolder(t)?a.folders[c]=t.slice(0,-1):a.files[c]=t,c++}),a.folders.sort(),a.files.sort(),a},e.isFolder=function(e){return"/"==e[e.length-1]},e.eventClickName=function(){document.querySelectorAll("stair-case li .sc-name").forEach(function(a){a.addEventListener("click",function(a){let c=a.currentTarget.closest("li"),n=e.setData(c);e.removeActive(),e.setActive(c),t.callbackActive(n)})})},e.eventClickToggle=function(e){let t=e.querySelector(":scope > .sc-current > .sc-icon");t&&t.addEventListener("click",function(t){console.log("jens"),"open"==e.dataset.scState?e.dataset.scState="close":e.dataset.scState="open"})},e.eventClickFolder=function(t){t.querySelectorAll('li[data-sc-type="folder"]:not([data-children]) .sc-icon').forEach(function(t){t.addEventListener("click",function(t){var a=t.currentTarget.closest("[data-sc-name]");if(void 0===a.dataset.children){let t=a.dataset.scName;id=e.trimSlashes(t),e.ajax(id)}},!0)})},e.trimSlashes=function(e){return(e=e.replace(/^\/|\/$/g,"")).replace(/^\/|\/$/g,"")},e.setData=function(e){var t={};return t.element=e,t.name=e.dataset.scName,t.type=e.dataset.scType,t},e.removeActive=function(){document.querySelectorAll("stair-case li").forEach(function(e){e.classList.remove("sc-active")})},e.setActive=function(e){e.classList.add("sc-active")},e}();